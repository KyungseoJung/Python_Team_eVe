"<!-- // T-Map appkey = 5RB8KXlDuB6uLZGhugCqS9OJMViZ73P93dRPbphu -->

<!-- //#26 관리자(Administrator) 웹화면 디자인 구성 -->
<!-- //#27 관리자 웹페이지 디자인 -->

<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>관리자 페이지</title>
    <style>
      /* //#27 
      Body나 HTML 태그의 마진 또는 패딩: 기본적으로 브라우저는 HTML 페이지의 body 태그에 마진이나 패딩을 자동으로 추가하기 때문에 공백이 발생할 수 있음
      -> 이를 제거하려면 CSS에서 body와 html 태그의 마진과 패딩을 0으로 설정해야 함.
      불필요한 태그나 공백: HTML 코드 내에 불필요한 공백이나 태그가 있을 경우 이를 정리함. */
      html,
      body {
        margin: 0;
        padding: 0;
      }
      body {
        font-family: Arial, sans-serif;
      }
      .navbar {
        /* //#27 불필요한 공백 제거 */
        margin-top: 0;
        padding-top: 0;

        background: #333;
        padding: 10px 40px;
        color: white;
        text-align: right;
      }
      .button {
        color: white;
        background: gray;
        padding: 10px 40px;
        border: none;
        cursor: pointer;
        margin-right: 10px;
        font-size: 17px; /* Larger font size */
      }
      .button.active {
        background: red;
      }
      /* [주문 관리] 페이지 화면 속 버튼 */
      .button-check {
        /* color: white;
        background: gray;
        padding: 10px 20px;
        border: none;
        cursor: pointer;
        margin-right: 10px; */

        color: black;
        background: #ffd8d8; /* Dark grey background */
        border: 1.5px solid #000000;
        padding: 10px 40px; /* Larger buttons */
        cursor: pointer;
        font-size: 20px; /* Larger font size */
        border-radius: 5px; /* Rounded corners */
      }
      .button-calculate {
        color: white;
        background: #000000; /* Dark grey background */
        border: 1.5px solid #ffffff;
        padding: 10px 20px; /* Larger buttons */
        cursor: pointer;
        font-size: 20px; /* Larger font size */
        border-radius: 5px; /* Rounded corners */
      }
      .button-save {
        color: white;
        background: #000000; /* Dark grey background */
        border: 1.5px solid #000000;
        padding: 10px 30px; /* Larger buttons */
        cursor: pointer;
        font-size: 20px; /* Larger font size */
        border-radius: 5px; /* Rounded corners */
      }
      #content {
        /* //#27 불필요한 공백 제거 */
        margin-top: 0;
        padding-top: 0;

        padding: 20px;
        display: flex;
        justify-content: space-around;
      }
      .panel {
        border: 1px solid #ccc;
        padding: 10px;
        margin: 20px;
        width: 48%;
      }
      .section {
        display: none;
        flex: 1;
        margin: 0 10px;
        border: 1px solid #ccc;
        padding: 10px;
      }
      .visible {
        display: flex;
      }
      table,
      th,
      td {
        border: 1px solid black;
        border-collapse: collapse;
        padding: 8px;
      }
      .hidden {
        display: none;
      }
      .loader-container {
        display: flex;
        align-items: center;
        margin-top: 20px;
        margin-bottom: 20px;
        gap: 20px;
      }
      .loader {
        width: 100px;
        height: 20px;
        background: gray;
      }
      .loader-bar {
        height: 100%;
        background: lightgreen;
        width: 0%;
      }
      /* complete 됐을 때, 초록색으로 로딩바 가득 채우기 */
      .complete {
        background-color: green;
        width: 100% !important;
      }
      .disabled {
        pointer-events: none;
        opacity: 0.4;
      }
      /* #27 데이터 테이블 스크롤 가능하도록 */
      .table-container {
        overflow-y: auto;
        max-height: 400px;
      } /* Scrollable container */
    </style>
  </head>
  <body>
    <div class="navbar">
      <button class="button active" onclick="showSection('order')">
        주문 관리
      </button>
      <button class="button" onclick="showSection('delivery')">
        배달 관리
      </button>
      <button class="button" onclick="showSection('battery')">
        배터리 관리
      </button>
    </div>
    <div id="content">
      <div id="order" class="section visible">
        <div class="panel">
          <h2>주문 데이터 확인</h2>
          <button class="button-check" onclick="loadCSVData()">
            <img
              src="https://cdn-icons-png.flaticon.com/128/9159/9159105.png"
              alt="Load Icon"
              style="
                height: 30px;
                width: 30px;
                vertical-align: middle;
                margin-right: 5px;
              "
            />

            Load CSV Data
          </button>
          <div class="table-container">
            <table id="data-table"></table>
          </div>
        </div>
        <div class="panel">
          <h2>경로 계산</h2>
          <button class="button-calculate" onclick="calculatePath()">
            <img
              src="https://cdn-icons-png.flaticon.com/128/9422/9422848.png"
              alt="Load Icon"
              style="
                height: 30px;
                width: 30px;
                vertical-align: middle;
                margin-right: 5px;
              "
            />
            경로 계산하기
          </button>
          <div class="loader-container hidden">
            <div class="loader">
              <div class="loader-bar"></div>
            </div>
            <!-- 로딩바 완료 메시지 -->
            <span id="completeLabel" class="hidden">Complete!</span>
          </div>
          <button class="button-save" onclick="saveFile()">
            <img
              src="https://cdn-icons-png.flaticon.com/128/2480/2480719.png"
              alt="Load Icon"
              style="
                height: 30px;
                width: 30px;
                vertical-align: middle;
                margin-right: 5px;
              "
            />
            파일 저장
          </button>
        </div>
      </div>
      <div id="delivery" class="section">
        <h2>구현 예정입니다~</h2>
      </div>
      <div id="battery" class="section">
        <h2>구현 예정입니다~</h2>
      </div>
    </div>

    <script>
      //#27 경로 계산 전에는 버튼 비활성화 되어 있도록
      document.querySelectorAll(".button-check").forEach((btn) => {
        btn.classList.add("disabled");
      });
      document.querySelectorAll(".button-save").forEach((btn) => {
        btn.classList.add("disabled");
      });

      function showSection(section) {
        document.querySelectorAll(".section").forEach((sec) => {
          sec.classList.remove("visible");
        });
        document.querySelectorAll(".button").forEach((btn) => {
          btn.classList.remove("active");
          btn.disabled = false; // Enable all buttons
        });
        document.getElementById(section).classList.add("visible");
        document
          .querySelector(`.button[onclick="showSection('${section}')"]`)
          .classList.add("active");
      }

      function calculatePath() {
        disableButtons(); // 다른 버튼들 모두 비활성화
        const loaderContainer = document.querySelector(".loader-container");
        const loaderBar = document.querySelector(".loader-bar");
        const completeLabel = document.getElementById("completeLabel");
        loaderContainer.classList.remove("hidden");
        let width = 0;
        const interval = setInterval(() => {
          if (width >= 100) {
            clearInterval(interval);
            alert("경로 계산 완료");
            // loaderBar.style.width = "0%";
            loaderBar.className = "loader-bar complete"; // 경로 계산 마침 - 계속 초록색으로 로딩바 채워져 있도록 (Complete!)
            completeLabel.classList.remove("hidden");
            loaderContainer.classList.add("hidden");
            enableButtons(); // 다른 버튼들 모두 활성화
          } else {
            width++;
            loaderBar.style.width = `${width}%`;
          }
        }, 10);
      }

      function disableButtons() {
        document.querySelectorAll(".button").forEach((btn) => {
          btn.classList.add("disabled");
        });
        //#27 이미 비활성화 되어있음
        // document.querySelectorAll(".button-check").forEach((btn) => {
        //   btn.classList.add("disabled");
        // });
        document.querySelectorAll(".button-calculate").forEach((btn) => {
          btn.classList.add("disabled");
        });
        //#27 이미 비활성화 되어있음
        // document.querySelectorAll(".button-save").forEach((btn) => {
        //   btn.classList.add("disabled");
        // });
      }

      function enableButtons() {
        document.querySelectorAll(".button").forEach((btn) => {
          btn.classList.remove("disabled");
        });
        document.querySelectorAll(".button-check").forEach((btn) => {
          btn.classList.remove("disabled");
        });
        //#27
        // document.querySelectorAll(".button-calculate").forEach((btn) => {
        //   btn.classList.remove("disabled");
        // });
        document.querySelectorAll(".button-save").forEach((btn) => {
          btn.classList.remove("disabled");
        });
      }

      function saveFile() {
        alert("파일이 저장되었습니다!");
        // Placeholder for file saving function
      }

      function loadCSVData() {
        fetch("/static/deliveries.csv")
          .then((response) => response.text())
          .then((data) => {
            const rows = data.split("\n").map((row) => row.split(","));
            const table = document.getElementById("data-table");
            table.innerHTML = ""; // Clear previous data
            rows.forEach((row, index) => {
              const tr = document.createElement("tr");
              row.forEach((cell) => {
                const td = document.createElement("td");
                td.textContent = cell;
                tr.appendChild(td);
              });
              table.appendChild(tr);
            });
          })
          .catch((error) => {
            alert("Error loading data: " + error);
          });
      }
    </script>
  </body>
</html>
"
