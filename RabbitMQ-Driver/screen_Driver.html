<!-- //#16 웹화면 디자인 구성 -->
<!-- //#17 웹화면 기능 구현 
#17-1 [배달 완료] 또는 [수거 완료] 버튼 둘 중 하나만 활성화
#17-2 배달 정보에 위도, 경도 데이터도 추가해서 순서대로 표시하는 기능
#17-3 모든 작업을 완료했을 시, 팝업창을 띄우고 기존 표시 문구를 수정

-->
<!DOCTYPE html>
<html lang="ko">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>0513_웹화면 구상</title>
    <style>
      body {
        margin: 0;
        font-family: Arial, sans-serif;
      }
      .container {
        display: flex;
        height: 100vh;
      }
      .sidebar {
        width: 300px;
        background-color: #f0f0f0;
        display: flex;
        flex-direction: column;
        justify-content: space-between;
        padding: 20px;
      }
      .map {
        flex: 1;
        background-color: #1e88e5;
        display: flex;
        justify-content: center;
        align-items: center;
        color: white;
        font-size: 36px;
      }
      .header {
        font-size: 24px;
        font-weight: bold;
        text-align: center;
        margin-bottom: 30px;
      }
      .delivery-info {
        display: grid;
        /* grid-template-columns: 1fr 1fr; */
        gap: 10px;
        background-color: white;
        padding: 20px;
        border: 1px solid #ccc;
        border-radius: 5px;
        margin-bottom: 20px;
      }
      .time-info {
        display: grid;
        grid-template-columns: 1fr 1fr;
        gap: 10px;
        background-color: white;
        padding: 20px;
        border: 1px solid #ccc;
        border-radius: 5px;
        margin-bottom: 20px;
      }
      .time-info div {
        margin-bottom: 10px;
      }
      .item {
        display: flex;
        align-items: center;
        justify-content: center;
        padding: 30px;
        border: 3px solid #ff4848;
        font-size: 1.2em;
      }
      .fixed-text {
        display: flex;
        align-items: center;
        justify-content: center;
        padding: 10px;
      }
      .buttons {
        display: flex;
        flex-direction: column;
        gap: 10px;
      }
      .button {
        padding: 10px;
        text-align: center;
        background-color: #007bff;
        color: white;
        border: none;
        border-radius: 5px;
        cursor: pointer;
      }
      .button:active {
        background-color: #0056b3;
      }
      .button:last-child {
        margin-bottom: 0;
      }
      .button:disabled {
        background-color: #cccccc;
        cursor: not-allowed;
      }
    </style>
  </head>
  <body>
    <div class="container">
      <div class="sidebar">
        <div>
          <div class="header">경로 표시</div>
          <div class="delivery-info">
            <div class="item" id="delivery-type"><strong>배달</strong></div>
          </div>
          <!-- <div class="delivery-info">
            <div class="fixed-text">경기도 안양시 만안구 화창로</div>
          </div> -->
          <div class="delivery-info">
            <div class="fixed-text">
              <!--Latitude:-->
              <span id="latitude"></span>
            </div>
            <div class="fixed-text">
              <!--Longitude: -->
              <span id="longitude"></span>
            </div>
          </div>

          <div class="time-info">
            <div class="item" id="arrivalTime"><strong>"시간"</strong></div>
            <div class="fixed-text">까지 도착</div>
          </div>
        </div>
        <div class="buttons">
          <button class="button" id="delivery-complete">
            배달 완료<br />(서비스 시작)
          </button>
          <button class="button" id="pickup-complete">
            수거 완료<br />(서비스 완료)
          </button>
        </div>
      </div>
      <div class="map">지도</div>
    </div>

    <script>
      document.addEventListener("DOMContentLoaded", function () {
        // Sample JSON data - 추후 수리모형 팀에서 받아야 하는 데이터
        var deliveries = [
          { delivery_type: "배달", location: [37.337179, 127.245669] },
          { delivery_type: "수거", location: [37.3372644, 127.246081] },
          { delivery_type: "배달", location: [37.337349800000005, 127.246493] },
          { delivery_type: "수거", location: [37.33743520000001, 127.246905] },
          { delivery_type: "배달", location: [37.33752060000001, 127.247317] },

          // 나머지 데이터 추가 필요
        ];

        var currentIndex = 0; // 현재 데이터 순서를 확인하기 위한 변수
        // 배달 유형 표시 문구
        var deliveryType = document.getElementById("delivery-type");
        // 위치 데이터 표시 문구
        var latitudeDisplay = document.getElementById("latitude");
        var longitudeDisplay = document.getElementById("longitude");
        // 도착 시간 표시 문구
        var arrivalTimeDisplay = document.getElementById("arrivalTime");

        var deliveryCompleteBtn = document.getElementById("delivery-complete");
        var pickupCompleteBtn = document.getElementById("pickup-complete");

        // 배달 유형(delivery_type), 위치 데이터(위도, 경도) 데이터를 업데이트 & 버튼 상태 업데이트 함수
        function updateDeliveryInfo() {
          deliveryType.innerText = deliveries[currentIndex]["delivery_type"];
          latitudeDisplay.innerText = deliveries[currentIndex]["location"][0];
          longitudeDisplay.innerText = deliveries[currentIndex]["location"][1];

          //========== #17-3 모든 배달 정보를 마치면, 팝업창과 함께 두 버튼 모두 비활성화
          if (currentIndex >= deliveries.length - 1) {
            // 두 버튼 모두 비활성화
            deliveryCompleteBtn.disabled = true;
            pickupCompleteBtn.disabled = true;
            alert("오늘 작업을 완료했습니다!!"); // 작업 완료 팝업
            // (delivery_type & 위치 데이터) 표시 부분 업데이트
            deliveryType.innerText = "작업 완료";
            latitudeDisplay.innerText = "";
            longitudeDisplay.innerText = "";
            arrivalTimeDisplay.innerText = "";
          } else {
            if (deliveryType.innerText.trim() === "배달") {
              deliveryCompleteBtn.disabled = false;
              pickupCompleteBtn.disabled = true;
            } else {
              deliveryCompleteBtn.disabled = true;
              pickupCompleteBtn.disabled = false;
            }
          }
        }

        // 초기 정보 표시 및 업데이트
        updateDeliveryInfo();

        // [배달 완료] 및 [수거 완료] 버튼에 이벤트 리스너 추가
        deliveryCompleteBtn.addEventListener("click", function () {
          if (currentIndex < deliveries.length - 1) {
            currentIndex++; // 다음 데이터 (delivery_type, 위치 데이터) 표시
            updateDeliveryInfo();
          }
        });

        pickupCompleteBtn.addEventListener("click", function () {
          if (currentIndex < deliveries.length - 1) {
            currentIndex++; // 다음 데이터 (delivery_type, 위치 데이터) 표시
            updateDeliveryInfo();
          }
        });
      });
    </script>
  </body>
</html>
